<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title></title>
	<style type="text/css">
		ul{
			width: 200px;
			background-color: skyblue;
			list-style: none;
			margin: 0;
			padding: 0;
		}
		ul li{
			height: 25px;
			border: 1px solid black;
		}
		ul li:hover{
			background-color: yellowgreen;
		}
		#menu{
			position: absolute;
			display: none;
		}
		#menu li{
			position: relative;
		}
		#menu li ul{
			position: absolute;
			left: 198px;
			top: 0;
			display: none;
		}
		#menu li:hover ul{
			display: block;
		}
	</style>
</head>
<body>
<ul id="menu">
	<li>1
		<ul class="menu2">
			<li>1.1</li>
			<li>1.2</li>
			<li>1.3</li>
			<li>1.4</li>
		</ul>
	</li>
	<li>2
		<ul class="menu2">
			<li>2.1</li>
			<li>2.2</li>
			<li>2.3</li>
			<li>2.4</li>
		</ul>
	</li>
	<li>3
		<ul class="menu2">
			<li>3.1</li>
			<li>3.2</li>
			<li>3.3</li>
			<li>3.4</li>
		</ul>
	</li>
</ul>
<script type="text/javascript">
	var menu = document.getElementById("menu");
	var winW = document.documentElement.clientWidth;
	var winH =document.documentElement.clientHeight;
	window.oncontextmenu = function(event){
		var e = window.event||event;
		var x = e.clientX+1;
		var y = e.clientY+1;
		menu.style.display = "block";
		//获取元素的宽高与位置，要在元素显示出来后才能够正常获取
		var width = menu.offsetWidth;
		var height = menu.offsetHeight;
		if(x+width>winW){
			x = x-width;
		}
		if(y+height>winH){
			y = y-height;
		}
		menu.style.left = x + "px";
		menu.style.top = y + "px";
		e.preventDefault();
		//使用事件委托
		var list = menu.children;
		menu.onmouseover = function (event) {
			var e = window.event || event;
			var target = e.target || e.srcElement;
			var menu2 = target.children[0];
			if(menu2){
				var mW = menu2.offsetWidth;
				var mH = menu2.offsetHeight;
				var mL = width;
				var mT = 0;
				if(x+width+mW>winW){
					mL = -mL;
				}
				if(y+target.offsetTop+mH>winH){
					mT = - mH + target.offsetHeight;
				}
				menu2.style.left = mL-1 + "px";
				menu2.style.top = mT + "px";
			}
		}
		/*menu.onmouseover = function(){
			for (var i = 0; i < menu.children.length; i++) {
				var list = menu.children;
				var menu2 = list[i].children;
				var mW = menu2[0].offsetWidth;
				var mH = menu2[0].offsetHeight;
				var mL = width;
				var mT = 0;
				if(x+width+mW>winW){
					mL = -mL;
				}
				if(y+list[i].offsetTop+mH>winH){
					mT = - mH + list[i].offsetHeight;
				}
				menu2[0].style.left = mL-1 + "px";
				menu2[0].style.top = mT + "px";
			}
		}*/
	}
	window.onclick = function(){
		menu.style.display = "none";
	};
</script>
</body>
</html>
